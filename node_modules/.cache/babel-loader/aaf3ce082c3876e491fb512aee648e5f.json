{"ast":null,"code":"import loader from '@monaco-editor/loader';\nimport React, { useState, useRef, useCallback, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport MonacoContainer from '../MonacoContainer/index.js';\nimport useMount from '../hooks/useMount/index.js';\nimport useUpdate from '../hooks/useUpdate/index.js';\nimport { getOrCreateModel, noop, isUndefined } from '../utils/index.js';\nimport usePrevious from '../hooks/usePrevious/index.js';\nconst viewStates = new Map();\n\nfunction Editor({\n  defaultValue,\n  defaultLanguage,\n  defaultPath,\n  value,\n  language,\n  path,\n\n  /* === */\n  theme,\n  line,\n  loading,\n  options,\n  overrideServices,\n  saveViewState,\n  keepCurrentModel,\n\n  /* === */\n  width,\n  height,\n  className,\n  wrapperProps,\n\n  /* === */\n  beforeMount,\n  onMount,\n  onChange,\n  onValidate\n}) {\n  const [isEditorReady, setIsEditorReady] = useState(false);\n  const [isMonacoMounting, setIsMonacoMounting] = useState(true);\n  const monacoRef = useRef(null);\n  const editorRef = useRef(null);\n  const containerRef = useRef(null);\n  const onMountRef = useRef(onMount);\n  const beforeMountRef = useRef(beforeMount);\n  const subscriptionRef = useRef(null);\n  const valueRef = useRef(value);\n  const previousPath = usePrevious(path);\n  useMount(() => {\n    const cancelable = loader.init();\n    cancelable.then(monaco => (monacoRef.current = monaco) && setIsMonacoMounting(false)).catch(error => (error === null || error === void 0 ? void 0 : error.type) !== 'cancelation' && console.error('Monaco initialization: error:', error));\n    return () => editorRef.current ? disposeEditor() : cancelable.cancel();\n  });\n  useUpdate(() => {\n    const model = getOrCreateModel(monacoRef.current, defaultValue || value, defaultLanguage || language, path);\n\n    if (model !== editorRef.current.getModel()) {\n      saveViewState && viewStates.set(previousPath, editorRef.current.saveViewState());\n      editorRef.current.setModel(model);\n      saveViewState && editorRef.current.restoreViewState(viewStates.get(path));\n    }\n  }, [path], isEditorReady);\n  useUpdate(() => {\n    editorRef.current.updateOptions(options);\n  }, [options], isEditorReady);\n  useUpdate(() => {\n    if (editorRef.current.getOption(monacoRef.current.editor.EditorOption.readOnly)) {\n      editorRef.current.setValue(value);\n    } else {\n      if (value !== editorRef.current.getValue()) {\n        editorRef.current.executeEdits('', [{\n          range: editorRef.current.getModel().getFullModelRange(),\n          text: value,\n          forceMoveMarkers: true\n        }]);\n        editorRef.current.pushUndoStop();\n      }\n    }\n  }, [value], isEditorReady);\n  useUpdate(() => {\n    monacoRef.current.editor.setModelLanguage(editorRef.current.getModel(), language);\n  }, [language], isEditorReady);\n  useUpdate(() => {\n    // reason for undefined check: https://github.com/suren-atoyan/monaco-react/pull/188\n    if (!isUndefined(line)) {\n      editorRef.current.revealLine(line);\n    }\n  }, [line], isEditorReady);\n  useUpdate(() => {\n    monacoRef.current.editor.setTheme(theme);\n  }, [theme], isEditorReady);\n  const createEditor = useCallback(() => {\n    beforeMountRef.current(monacoRef.current);\n    const autoCreatedModelPath = path || defaultPath;\n    const defaultModel = getOrCreateModel(monacoRef.current, value || defaultValue, defaultLanguage || language, autoCreatedModelPath);\n    editorRef.current = monacoRef.current.editor.create(containerRef.current, {\n      model: defaultModel,\n      automaticLayout: true,\n      ...options\n    }, overrideServices);\n    saveViewState && editorRef.current.restoreViewState(viewStates.get(autoCreatedModelPath));\n    monacoRef.current.editor.setTheme(theme);\n    setIsEditorReady(true);\n  }, [defaultValue, defaultLanguage, defaultPath, value, language, path, options, overrideServices, saveViewState, theme]);\n  useEffect(() => {\n    if (isEditorReady) {\n      onMountRef.current(editorRef.current, monacoRef.current);\n    }\n  }, [isEditorReady]);\n  useEffect(() => {\n    !isMonacoMounting && !isEditorReady && createEditor();\n  }, [isMonacoMounting, isEditorReady, createEditor]); // subscription\n  // to avoid unnecessary updates (attach - dispose listener) in subscription\n\n  valueRef.current = value;\n  useEffect(() => {\n    if (isEditorReady && onChange) {\n      var _subscriptionRef$curr, _editorRef$current;\n\n      (_subscriptionRef$curr = subscriptionRef.current) === null || _subscriptionRef$curr === void 0 ? void 0 : _subscriptionRef$curr.dispose();\n      subscriptionRef.current = (_editorRef$current = editorRef.current) === null || _editorRef$current === void 0 ? void 0 : _editorRef$current.onDidChangeModelContent(event => {\n        const editorValue = editorRef.current.getValue();\n\n        if (valueRef.current !== editorValue) {\n          onChange(editorValue, event);\n        }\n      });\n    }\n  }, [isEditorReady, onChange]); // onValidate\n\n  useEffect(() => {\n    if (isEditorReady) {\n      const changeMarkersListener = monacoRef.current.editor.onDidChangeMarkers(uris => {\n        var _editorRef$current$ge;\n\n        const editorUri = (_editorRef$current$ge = editorRef.current.getModel()) === null || _editorRef$current$ge === void 0 ? void 0 : _editorRef$current$ge.uri;\n\n        if (editorUri) {\n          const currentEditorHasMarkerChanges = uris.find(uri => uri.path === editorUri.path);\n\n          if (currentEditorHasMarkerChanges) {\n            const markers = monacoRef.current.editor.getModelMarkers({\n              resource: editorUri\n            });\n            onValidate === null || onValidate === void 0 ? void 0 : onValidate(markers);\n          }\n        }\n      });\n      return () => {\n        changeMarkersListener === null || changeMarkersListener === void 0 ? void 0 : changeMarkersListener.dispose();\n      };\n    }\n  }, [isEditorReady, onValidate]);\n\n  function disposeEditor() {\n    var _subscriptionRef$curr2;\n\n    (_subscriptionRef$curr2 = subscriptionRef.current) === null || _subscriptionRef$curr2 === void 0 ? void 0 : _subscriptionRef$curr2.dispose();\n\n    if (keepCurrentModel) {\n      saveViewState && viewStates.set(path, editorRef.current.saveViewState());\n    } else {\n      var _editorRef$current$ge2;\n\n      (_editorRef$current$ge2 = editorRef.current.getModel()) === null || _editorRef$current$ge2 === void 0 ? void 0 : _editorRef$current$ge2.dispose();\n    }\n\n    editorRef.current.dispose();\n  }\n\n  return /*#__PURE__*/React.createElement(MonacoContainer, {\n    width: width,\n    height: height,\n    isEditorReady: isEditorReady,\n    loading: loading,\n    _ref: containerRef,\n    className: className,\n    wrapperProps: wrapperProps\n  });\n}\n\nEditor.propTypes = {\n  defaultValue: PropTypes.string,\n  defaultPath: PropTypes.string,\n  defaultLanguage: PropTypes.string,\n  value: PropTypes.string,\n  language: PropTypes.string,\n  path: PropTypes.string,\n\n  /* === */\n  theme: PropTypes.string,\n  line: PropTypes.number,\n  loading: PropTypes.oneOfType([PropTypes.element, PropTypes.string]),\n  options: PropTypes.object,\n  overrideServices: PropTypes.object,\n  saveViewState: PropTypes.bool,\n  keepCurrentModel: PropTypes.bool,\n\n  /* === */\n  width: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  height: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  className: PropTypes.string,\n  wrapperProps: PropTypes.object,\n\n  /* === */\n  beforeMount: PropTypes.func,\n  onMount: PropTypes.func,\n  onChange: PropTypes.func,\n  onValidate: PropTypes.func\n};\nEditor.defaultProps = {\n  theme: 'light',\n  loading: 'Loading...',\n  options: {},\n  overrideServices: {},\n  saveViewState: true,\n  keepCurrentModel: false,\n\n  /* === */\n  width: '100%',\n  height: '100%',\n  wrapperProps: {},\n\n  /* === */\n  beforeMount: noop,\n  onMount: noop,\n  onValidate: noop\n};\nexport default Editor;","map":{"version":3,"sources":["C:/Users/Dhruv/Downloads/projects OP/CodePlay/node_modules/@monaco-editor/react/lib/es/Editor/Editor.js"],"names":["loader","React","useState","useRef","useCallback","useEffect","PropTypes","MonacoContainer","useMount","useUpdate","getOrCreateModel","noop","isUndefined","usePrevious","viewStates","Map","Editor","defaultValue","defaultLanguage","defaultPath","value","language","path","theme","line","loading","options","overrideServices","saveViewState","keepCurrentModel","width","height","className","wrapperProps","beforeMount","onMount","onChange","onValidate","isEditorReady","setIsEditorReady","isMonacoMounting","setIsMonacoMounting","monacoRef","editorRef","containerRef","onMountRef","beforeMountRef","subscriptionRef","valueRef","previousPath","cancelable","init","then","monaco","current","catch","error","type","console","disposeEditor","cancel","model","getModel","set","setModel","restoreViewState","get","updateOptions","getOption","editor","EditorOption","readOnly","setValue","getValue","executeEdits","range","getFullModelRange","text","forceMoveMarkers","pushUndoStop","setModelLanguage","revealLine","setTheme","createEditor","autoCreatedModelPath","defaultModel","create","automaticLayout","_subscriptionRef$curr","_editorRef$current","dispose","onDidChangeModelContent","event","editorValue","changeMarkersListener","onDidChangeMarkers","uris","_editorRef$current$ge","editorUri","uri","currentEditorHasMarkerChanges","find","markers","getModelMarkers","resource","_subscriptionRef$curr2","_editorRef$current$ge2","createElement","_ref","propTypes","string","number","oneOfType","element","object","bool","func","defaultProps"],"mappings":"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","sourcesContent":["import loader from '@monaco-editor/loader';\nimport React, { useState, useRef, useCallback, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport MonacoContainer from '../MonacoContainer/index.js';\nimport useMount from '../hooks/useMount/index.js';\nimport useUpdate from '../hooks/useUpdate/index.js';\nimport { getOrCreateModel, noop, isUndefined } from '../utils/index.js';\nimport usePrevious from '../hooks/usePrevious/index.js';\n\nconst viewStates = new Map();\n\nfunction Editor({\n  defaultValue,\n  defaultLanguage,\n  defaultPath,\n  value,\n  language,\n  path,\n\n  /* === */\n  theme,\n  line,\n  loading,\n  options,\n  overrideServices,\n  saveViewState,\n  keepCurrentModel,\n\n  /* === */\n  width,\n  height,\n  className,\n  wrapperProps,\n\n  /* === */\n  beforeMount,\n  onMount,\n  onChange,\n  onValidate\n}) {\n  const [isEditorReady, setIsEditorReady] = useState(false);\n  const [isMonacoMounting, setIsMonacoMounting] = useState(true);\n  const monacoRef = useRef(null);\n  const editorRef = useRef(null);\n  const containerRef = useRef(null);\n  const onMountRef = useRef(onMount);\n  const beforeMountRef = useRef(beforeMount);\n  const subscriptionRef = useRef(null);\n  const valueRef = useRef(value);\n  const previousPath = usePrevious(path);\n  useMount(() => {\n    const cancelable = loader.init();\n    cancelable.then(monaco => (monacoRef.current = monaco) && setIsMonacoMounting(false)).catch(error => (error === null || error === void 0 ? void 0 : error.type) !== 'cancelation' && console.error('Monaco initialization: error:', error));\n    return () => editorRef.current ? disposeEditor() : cancelable.cancel();\n  });\n  useUpdate(() => {\n    const model = getOrCreateModel(monacoRef.current, defaultValue || value, defaultLanguage || language, path);\n\n    if (model !== editorRef.current.getModel()) {\n      saveViewState && viewStates.set(previousPath, editorRef.current.saveViewState());\n      editorRef.current.setModel(model);\n      saveViewState && editorRef.current.restoreViewState(viewStates.get(path));\n    }\n  }, [path], isEditorReady);\n  useUpdate(() => {\n    editorRef.current.updateOptions(options);\n  }, [options], isEditorReady);\n  useUpdate(() => {\n    if (editorRef.current.getOption(monacoRef.current.editor.EditorOption.readOnly)) {\n      editorRef.current.setValue(value);\n    } else {\n      if (value !== editorRef.current.getValue()) {\n        editorRef.current.executeEdits('', [{\n          range: editorRef.current.getModel().getFullModelRange(),\n          text: value,\n          forceMoveMarkers: true\n        }]);\n        editorRef.current.pushUndoStop();\n      }\n    }\n  }, [value], isEditorReady);\n  useUpdate(() => {\n    monacoRef.current.editor.setModelLanguage(editorRef.current.getModel(), language);\n  }, [language], isEditorReady);\n  useUpdate(() => {\n    // reason for undefined check: https://github.com/suren-atoyan/monaco-react/pull/188\n    if (!isUndefined(line)) {\n      editorRef.current.revealLine(line);\n    }\n  }, [line], isEditorReady);\n  useUpdate(() => {\n    monacoRef.current.editor.setTheme(theme);\n  }, [theme], isEditorReady);\n  const createEditor = useCallback(() => {\n    beforeMountRef.current(monacoRef.current);\n    const autoCreatedModelPath = path || defaultPath;\n    const defaultModel = getOrCreateModel(monacoRef.current, value || defaultValue, defaultLanguage || language, autoCreatedModelPath);\n    editorRef.current = monacoRef.current.editor.create(containerRef.current, {\n      model: defaultModel,\n      automaticLayout: true,\n      ...options\n    }, overrideServices);\n    saveViewState && editorRef.current.restoreViewState(viewStates.get(autoCreatedModelPath));\n    monacoRef.current.editor.setTheme(theme);\n    setIsEditorReady(true);\n  }, [defaultValue, defaultLanguage, defaultPath, value, language, path, options, overrideServices, saveViewState, theme]);\n  useEffect(() => {\n    if (isEditorReady) {\n      onMountRef.current(editorRef.current, monacoRef.current);\n    }\n  }, [isEditorReady]);\n  useEffect(() => {\n    !isMonacoMounting && !isEditorReady && createEditor();\n  }, [isMonacoMounting, isEditorReady, createEditor]); // subscription\n  // to avoid unnecessary updates (attach - dispose listener) in subscription\n\n  valueRef.current = value;\n  useEffect(() => {\n    if (isEditorReady && onChange) {\n      var _subscriptionRef$curr, _editorRef$current;\n\n      (_subscriptionRef$curr = subscriptionRef.current) === null || _subscriptionRef$curr === void 0 ? void 0 : _subscriptionRef$curr.dispose();\n      subscriptionRef.current = (_editorRef$current = editorRef.current) === null || _editorRef$current === void 0 ? void 0 : _editorRef$current.onDidChangeModelContent(event => {\n        const editorValue = editorRef.current.getValue();\n\n        if (valueRef.current !== editorValue) {\n          onChange(editorValue, event);\n        }\n      });\n    }\n  }, [isEditorReady, onChange]); // onValidate\n\n  useEffect(() => {\n    if (isEditorReady) {\n      const changeMarkersListener = monacoRef.current.editor.onDidChangeMarkers(uris => {\n        var _editorRef$current$ge;\n\n        const editorUri = (_editorRef$current$ge = editorRef.current.getModel()) === null || _editorRef$current$ge === void 0 ? void 0 : _editorRef$current$ge.uri;\n\n        if (editorUri) {\n          const currentEditorHasMarkerChanges = uris.find(uri => uri.path === editorUri.path);\n\n          if (currentEditorHasMarkerChanges) {\n            const markers = monacoRef.current.editor.getModelMarkers({\n              resource: editorUri\n            });\n            onValidate === null || onValidate === void 0 ? void 0 : onValidate(markers);\n          }\n        }\n      });\n      return () => {\n        changeMarkersListener === null || changeMarkersListener === void 0 ? void 0 : changeMarkersListener.dispose();\n      };\n    }\n  }, [isEditorReady, onValidate]);\n\n  function disposeEditor() {\n    var _subscriptionRef$curr2;\n\n    (_subscriptionRef$curr2 = subscriptionRef.current) === null || _subscriptionRef$curr2 === void 0 ? void 0 : _subscriptionRef$curr2.dispose();\n\n    if (keepCurrentModel) {\n      saveViewState && viewStates.set(path, editorRef.current.saveViewState());\n    } else {\n      var _editorRef$current$ge2;\n\n      (_editorRef$current$ge2 = editorRef.current.getModel()) === null || _editorRef$current$ge2 === void 0 ? void 0 : _editorRef$current$ge2.dispose();\n    }\n\n    editorRef.current.dispose();\n  }\n\n  return /*#__PURE__*/React.createElement(MonacoContainer, {\n    width: width,\n    height: height,\n    isEditorReady: isEditorReady,\n    loading: loading,\n    _ref: containerRef,\n    className: className,\n    wrapperProps: wrapperProps\n  });\n}\n\nEditor.propTypes = {\n  defaultValue: PropTypes.string,\n  defaultPath: PropTypes.string,\n  defaultLanguage: PropTypes.string,\n  value: PropTypes.string,\n  language: PropTypes.string,\n  path: PropTypes.string,\n\n  /* === */\n  theme: PropTypes.string,\n  line: PropTypes.number,\n  loading: PropTypes.oneOfType([PropTypes.element, PropTypes.string]),\n  options: PropTypes.object,\n  overrideServices: PropTypes.object,\n  saveViewState: PropTypes.bool,\n  keepCurrentModel: PropTypes.bool,\n\n  /* === */\n  width: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  height: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n  className: PropTypes.string,\n  wrapperProps: PropTypes.object,\n\n  /* === */\n  beforeMount: PropTypes.func,\n  onMount: PropTypes.func,\n  onChange: PropTypes.func,\n  onValidate: PropTypes.func\n};\nEditor.defaultProps = {\n  theme: 'light',\n  loading: 'Loading...',\n  options: {},\n  overrideServices: {},\n  saveViewState: true,\n  keepCurrentModel: false,\n\n  /* === */\n  width: '100%',\n  height: '100%',\n  wrapperProps: {},\n\n  /* === */\n  beforeMount: noop,\n  onMount: noop,\n  onValidate: noop\n};\n\nexport default Editor;\n"]},"metadata":{},"sourceType":"module"}